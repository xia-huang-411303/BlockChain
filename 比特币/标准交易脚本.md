为了进一步保证比特币的安全性，比特币开发者对客户端可以操作的脚本类型进行了限制，规定了客户端可运行的五种标准交易脚本，分别为P2PKH、P2PK、P2SH、MS和OP_Return，对应着不同的特性和用处。接下来，我们将对这五类脚本进行简要的介绍。

## P2P KH（Pay-to-Public-Key-Hash）
该类脚本为目前比特币网络上大多数交易所采用的交易脚本。这类交易脚本包含着一个锁定脚本，该脚本对交易输出进行锁定，即公钥和对应的公钥哈希值（PKH）。比特币网络上的大多数交易都是P2PKH交易，此类交易都含有一个锁定脚本，该脚本由公钥哈希实现阻止输出功能，公钥哈希即广为人知的比特币地址。由P2PKH脚本锁定的输出可以通过键入公钥和由相应私钥创设的数字签名得以解锁。

我们通过[[P2PKH脚本的例子|一个例子]]对P2PKH脚本进行介绍。
该模式中，锁定脚本的形式如下：
`OP_DUP OP_HASH160 <Public Key Hash> OP_EQUAL OP_CHECKSIG`
解锁脚本包含两个操作数，即使用者的签名和公钥：
`<Signature A> <PublicKey A>`
将解锁脚本和锁定脚本进行组合，获得如下的组合脚本：
`<Signature A> <PublicKey A> OP_DUP OP_HASH160 <Public Key Hash> OP_EQUAL OP_CHECKSIG` 
只有当解锁脚本与锁定脚本的设定条件相匹配时，执行组合脚本时才会显示结果为真（Ture）。即只有当解锁脚本提供了Alice的有效签名，交易执行结果才会被通过（结果为真）。

## P2PK（Pay-to-Public-Key）
P2PK模式是一种较为简单的交易脚本模式。但相比于P2PKH，由于其并未对用户的公钥进行哈希，所以可能会泄露用户公钥。目前，coinbase的交易常使用该模式。该模式中，锁定脚本的形式如下：
`<Public Key A> OP_CHECKSIG`
解锁脚本仅包含一个操作数，即使用者的签名：
`<Signature A>`
组合脚本如下：
`<Signature A><Public Key A> OP_CHECKSIG`
该组合脚本的意义为调用OP_CHECKSIG操作符，对私钥A的签名和私钥A对应的公钥进行验证，如果验证通过，则返回结果为真，通过校验。

## P2SH（Pay-to-Script-Hash）
P2SH相比于前两种脚本模式具有更强的灵活性，具体来说，其仅记录20字节的脚本哈希，从而对具体的脚本细节进行了保护。在需要使用通过该类脚本锁定的UTXO时，出示对应该哈希值的原始脚本，并保证脚本的运行结果为真即可。该模式中，锁定脚本的形式如下：
`HASH160 PUSHDATA（目标脚本哈希）EQUAL`
解锁时提供对应的目标脚本即可。

## 多重签名MS（Multi-Signature）
多重签名提供了这样一种解锁场景，即在相关的N个公钥中，需要提供M个公钥对应的签名，才可以对相应UTXO进行解锁。这类脚本在涉及多方协商交易的场景下较为有效。该模式中，通用的M－N多重签名锁定脚本（M为至少需要提供的签名数量，N为涉及的公钥总数）的形式如下：
`M <Public Key 1><Public Key 2>…<Public Key N> N OP_CHECKMULTISIG`
对应的解锁脚本的形式如下：
`OP_0 <Signature k><Signature j>…`
锁定脚本与解锁脚本结合，即可对提供的签名进行验证，从而达到多重签名锁定的目的。

## 数据记录输出（OP_Return）
数据记录输出脚本主要是用于对比特币功能的拓展。通过该类脚本，开发者可以在交易输出上增加80字节的非交易数据。
比特币交易脚本可以视为智能合约的雏形，不过它的机制相对来说比较简单，仅是一个堆栈式的指定OP指令解析引擎，所能够支持的规则较少，难以实现复杂的逻辑。然而比特币脚本无疑为后续区块链系统的智能合约的提出提供了一个原型，相当于给区块链系统增添了一个功能拓展接口，使区块链能够在更多的场景下发挥作用。
