数据层主要描述区块链的物理形式，是最底层的技术。本节主要从数据结构、数据存储方面进行总体介绍。

### 数据结构

为了实现数据的不可篡改性，现有的区块链平台在数据结构的设计上， 借鉴了Haber与Stornetta的研究工作，基于时间戳、[[哈希算法]]、[[数字签名算法]]等技术，形成以[[区块]]为单位的[[链式结构]]。区块链主要通过每个区块头中记录前一个区块的区块头哈希（创世区块除外），组成区块链式结构来保证不可篡改性。不同区块链平台在数据结构的具体细节上虽有差异，但整体上基本相同。

区块链的数据结构示意图如图所示
![[区块链数据结构示意图.png]]

通过[[默克尔树]]计算得到的 #交易默克尔根 可以快速验证区块中的交易数据是否被篡改；
通过 #前块哈希 可验证该区块之前直至创世区块的所有区块是否被篡改。

目前应用在区块链中的典型哈希算法包括：SHA-256、SHA-512以及国密SM3。

### 数据存储
在数据存储的设计上，由于区块链式结构数据需要在磁盘上进行持久化，通常会以文件形式存储，也有部分区块链系统使用数据库形式存储。文件存储更方便以日志形式的追加操作，数据库存储则更容易实现增删改查功能。
比特币、Fabric的区块链式结构以文件形式存储，其索引数据存储在 #LevelDB 数据库；以太坊的区块链式结构与索引都存储在 #LevelDB 数据库。除了存储区块链式结构数据，以太坊、Fabric还都基于LevelDB构建了 #状态数据库（ #WorldState ）以存储账户余额或业务状态数据。
在基于账户模型的区块链平台中，交易数据被打包进区块且经共识算法确认后，先追加写入区块链式结构，而后写入状态数据库。当新的节点加入区块链网络时，为了和已有节点数据保持一致，新节点需要同步区块链式结构数据以达到全网区块的高度，同时，状态数据库也需和全网同步。
为了让更多常规计算能力的个人计算机节点加入区块链网络，以充分实现去中心化的理念，比特币和以太坊都选择了LevelDB数据库存储索引或状态数据，因为LevelDB是轻量级的单机数据库，无须安装部署且写入性能高效。但是基于LevelDB数据库的架构方案显然无法满足企业级的业务需求（如高并发访问、Non-Key查询、复杂查询等），因此，很多区块链系统平台提供了插件化的数据访问机制，其除了支持LevelDB数据库，还额外支持 #CouchDB 分布式数据库、SQL等关系型数据库等
